<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>David Maraga: A Journey Through Time</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Georgia', serif;
            overflow: hidden;
            height: 100vh;
            background: #fafafa;
            -ms-overflow-style: none;
            scrollbar-width: none;
        }

        body::-webkit-scrollbar {
            display: none;
        }

        /* Join the Movement Button */
        .join-movement {
            text-decoration: none !important;
            font-family: 'Inter', sans-serif !important;
            font-weight: 800;
            position: fixed;
            top: 30px;
            right: 30px;
            background: rgba(0, 100, 0, 0.9);
            color: white;
            padding: 12px 24px;
            border-radius: 12px;
            font-size: 13px;
            letter-spacing: 1px;
            text-transform: titlecase;
            cursor: pointer;
            z-index: 2000;
            border: none;
            transition: all 0.3s ease;
            box-shadow: 0 2px 12px rgba(0, 100, 0, 0.3);
        }

        .join-movement:hover {
            text-decoration: none !important;
            background: #006400;
            transform: translateY(-2px);
            box-shadow: 0 4px 20px rgba(0, 100, 0, 0.5);
        }

        /* NAV - floating logo -> expand horizontal menu */
        .nav-toggle-container {
            position: fixed;
            top: 8px;
            left: 8px;               /* extreme left */
            z-index: 9000;
            display: inline-flex;
            align-items: flex-start;
            gap: 8px;
            font-family: inherit;
            pointer-events: auto;
        }

        .nav-toggle {
            width: 56px;
            height: 56px;
            border-radius: 12px;
            border: none;
            background: linear-gradient(180deg,#006400,#004d00);
            color: #fff;
            display: inline-flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            box-shadow: 0 8px 24px rgba(0,0,0,0.18);
            transition: transform 160ms ease, box-shadow 160ms ease;
            flex-shrink: 0;
        }
        .nav-toggle:active { transform: scale(0.96); }
        .nav-toggle img { width: 34px; height: 34px; border-radius: 50%; display:block; }

        .nav-bar {
            position: absolute;
            left: 0;
            top: calc(100% + 8px);                       /* open downward under logo */
            display: flex;
            flex-direction: column;                      /* vertical layout when opened */
            align-items: flex-start;
            gap: 8px;
            min-width: 220px;
            max-width: 360px;
            background: rgba(255,255,255,0.98);
            border-radius: 12px;
            padding: 10px;
            box-shadow: 0 12px 30px rgba(0,0,0,0.14);
            transform-origin: top left;                  /* grow downward from logo */
            transform: scaleY(0);                        /* collapsed state (vertical) */
            opacity: 0;
            pointer-events: none;
            transition: transform 240ms cubic-bezier(.2,.9,.3,1), opacity 180ms ease;
            overflow: hidden;
        }

        .nav-toggle-container.open .nav-bar {
            transform: scaleY(1);
            opacity: 1;
            pointer-events: auto;
        }

        .nav-links { list-style: none; display: flex; gap: 18px; margin: 0; padding: 0; align-items:center; }
        .nav-links a { color: #1a1a1a; text-decoration: none; font-weight: 600; padding: 8px 6px; display:inline-block; }
        .nav-links a:hover { color: #006400; }

        .nav-actions { display: flex; gap: 12px; align-items: center; }
        .nav-actions .social a { display:inline-flex; align-items:center; justify-content:center; width:34px; height:34px; color: #1a1a1a; text-decoration:none; opacity:0.95; border-radius:6px; }
        .nav-actions .social a:hover { opacity:1; transform: translateY(-2px); }

        .donate { background: #DC143C; color: #fff; padding: 8px 14px; border-radius: 8px; text-decoration: none; font-weight:700; box-shadow: 0 6px 18px rgba(220,20,60,0.18); }
        .donate:hover { background: #b30f30; }

        @media (max-width: 680px) {
            .nav-bar { margin-left: 8px; padding: 10px; gap: 10px; flex-direction: column; align-items: flex-start; }
            .nav-links { flex-direction: column; gap: 10px; }
        }

        /* Timeline Container */
        .timeline-wrapper {
            position: relative;
            /* reserve space for the fixed low-profile footer */
            height: calc(100vh - 64px);
            display: flex;
            align-items: center;
            padding: 0 10vw;
            min-width: max-content;
            padding-bottom: 80px;
        }

        /* Main Timeline Line with Animated Pulse */
        .timeline-line {
            position: absolute;
            top: 50%;
            left: 0;
            right: 0;
            height: 2px;
            background: linear-gradient(90deg, 
                #DC143C 0%, 
                #1a1a1a 25%, 
                #006400 50%, 
                #FFD700 75%, 
                #DC143C 100%
            );
            z-index: 1;
        }

        .timeline-line::after {
            content: '';
            position: absolute;
            left: 0;
            top: 0;
            height: 100%;
            width: 100px;
            background: linear-gradient(90deg, 
                transparent, 
                rgba(255, 215, 0, 0.4), 
                transparent
            );
            animation: timelinePulse 3s ease-in-out infinite;
        }

        @keyframes timelinePulse {
            0%, 100% { 
                left: -100px;
                opacity: 0;
            }
            50% { 
                opacity: 1;
            }
        }

        /* Timeline Track - Duplicate content for infinite loop */
        .timeline-track {
            display: flex;
            align-items: center;
            position: relative;
            z-index: 10;
        }

        /* Hide the loop marker - we don't need it anymore */
        .loop-back-marker {
            display: none;
        }

        /* Decade Markers with Centered Labels */
        .decade-marker {
            position: relative;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
        }

        .decade-line {
            width: 1px;
            height: 80px;
            background: #ddd;
            position: relative;
        }

        .decade-label {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            font-size: 12px;
            font-weight: 600;
            color: #1a1a1a;
            letter-spacing: 1px;
            white-space: nowrap;
            background: white;
            padding: 6px 14px;
            border-radius: 4px;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
            border: 1px solid #e0e0e0;
        }

        /* Timeline Moments with Beads */
        .timeline-moment {
            position: relative;
            display: flex;
            flex-direction: column;
            align-items: center;
        }

        /* Bead System */
        .bead-container {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            z-index: 20;
        }

        .bead {
            width: 14px;
            height: 14px;
            border-radius: 50%;
            border: 3px solid white;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.15);
        }

        /* Connector Lines from Beads */
        .connector-line {
            position: absolute;
            width: 2px;
            left: 50%;
            transform: translateX(-50%);
            opacity: 0.6;
        }

        .connector-line.top {
            top: -7px;
            height: 80px;
            transform-origin: top;
        }

        .connector-line.bottom {
            bottom: -7px;
            height: 80px;
            transform-origin: bottom;
        }

        /* Color cycling for beads */
        .timeline-moment:nth-child(3n+1) .bead { background: #DC143C; }
        .timeline-moment:nth-child(3n+1) .connector-line { background: #DC143C; }

        .timeline-moment:nth-child(3n+2) .bead { background: #1a1a1a; }
        .timeline-moment:nth-child(3n+2) .connector-line { background: #1a1a1a; }

        .timeline-moment:nth-child(3n) .bead { background: #006400; }
        .timeline-moment:nth-child(3n) .connector-line { background: #006400; }

        /* Special bead for 2017 Annulment */
        .annulment-moment .bead {
            width: 18px;
            height: 18px;
            background: #FFD700;
            box-shadow: 0 0 20px rgba(255, 215, 0, 0.6);
        }

        .annulment-moment .connector-line {
            background: #FFD700;
            width: 3px;
        }

        /* Cards with Rounded Corners - Green Shadow Behind */
        .timeline-card {
            width: 380px;
            background: white;
            border: 1px solid #e0e0e0;
            border-radius: 8px;
            padding: 35px 30px;
            opacity: 0;
            transform: translateY(20px);
            transition: all 0.6s cubic-bezier(0.4, 0, 0.2, 1);
            cursor: pointer;
            position: relative;
            box-shadow: 0 4px 20px rgba(0, 0, 0, 0.1);
        }

        .timeline-card::after {
            content: '';
            position: absolute;
            inset: 0;
            background: transparent;
            box-shadow: 0 8px 40px rgba(0, 100, 0, 0);
            border-radius: 8px;
            z-index: -1;
            transition: box-shadow 0.4s ease;
        }

        .timeline-card:hover::after {
            box-shadow: 0 12px 50px rgba(0, 100, 0, 0.35);
        }

        .timeline-card.visible {
            opacity: 1;
            transform: translateY(0);
        }

        .timeline-card:hover {
            transform: translateY(-8px);
            box-shadow: 0 8px 30px rgba(0, 0, 0, 0.15);
        }

        /* Position cards */
        .timeline-moment.top .timeline-card {
            position: absolute;
            bottom: 100px;
        }

        .timeline-moment.bottom .timeline-card {
            position: absolute;
            top: 100px;
        }

        /* Images - Borderless, Rounded Corners */
        .timeline-image {
            width: 380px;
            height: 280px;
            background: #f0f0f0;
            display: flex;
            align-items: center;
            justify-content: center;
            color: #ccc;
            font-size: 12px;
            opacity: 0;
            transform: translateY(20px);
            transition: all 0.6s ease;
            border-radius: 12px;
            overflow: hidden;
            cursor: pointer;
        }

        .timeline-image.visible {
            opacity: 1;
            transform: translateY(0);
        }

        .timeline-image:hover {
            transform: translateY(-4px);
            box-shadow: 0 8px 24px rgba(0, 0, 0, 0.12);
        }

        /* Position images */
        .timeline-moment.top .timeline-image {
            position: absolute;
            top: 100px;
        }

        .timeline-moment.bottom .timeline-image {
            position: absolute;
            bottom: 100px;
        }

        /* Card Content */
        .card-year {
            font-size: 12px;
            letter-spacing: 3px;
            color: #999;
            margin-bottom: 15px;
            text-transform: uppercase;
        }

        .card-title {
            font-family: 'Playfair Display', 'Georgia', serif;
            font-size: 24px;
            font-weight: 700;
            line-height: 1.2;
            color: #1a1a1a;
            margin-bottom: 18px;
        }

        .card-description {
            font-size: 15px;
            line-height: 1.7;
            color: #666;
        }

        .explore-hint {
            font-style: italic;
            font-size: 13px;
            color: #ccc;
            margin-top: 20px;
            opacity: 0.6;
        }

        /* 2017 Annulment Card Special Styling */
        .annulment-card .card-title {
            font-size: 28px;
            color: #DC143C;
        }

        /* Intermission Section - Playful Break */
        .intermission-section {
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            gap: 40px;
            padding: 60px 40px;
            position: relative;
        }

        .intermission-title {
            font-family: 'Playfair Display', 'Georgia', serif;
            font-size: 36px;
            font-weight: 700;
            color: #DC143C;
            text-align: center;
            font-style: italic;
        }

        .poster-gallery {
            display: flex;
            gap: 30px;
            align-items: center;
            perspective: 1000px;
        }

        .poster-card {
            width: 180px;
            background: white;
            border-radius: 8px;
            padding: 12px;
            box-shadow: 0 8px 24px rgba(0, 0, 0, 0.15);
            transform: rotate(var(--rotation, 0deg));
            transition: all 0.4s ease;
            animation: posterFloat 3s ease-in-out infinite;
            animation-delay: calc(var(--index, 0) * 0.5s);
        }

        .poster-card:nth-child(1) { 
            --index: 0;
            --rotation: -8deg;
        }
        .poster-card:nth-child(2) { 
            --index: 1;
            --rotation: 5deg;
        }
        .poster-card:nth-child(3) { 
            --index: 2;
            --rotation: -3deg;
        }

        @keyframes posterFloat {
            0%, 100% { transform: rotate(var(--rotation)) translateY(0); }
            50% { transform: rotate(var(--rotation)) translateY(-12px); }
        }

        .poster-card:hover {
            transform: rotate(0deg) scale(1.1);
            z-index: 10;
        }

        .poster-image {
            width: 100%;
            height: 220px;
            background: linear-gradient(135deg, #DC143C 0%, #006400 100%);
            border-radius: 6px;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-size: 12px;
            margin-bottom: 12px;
        }

        .poster-caption {
            text-align: center;
            font-size: 16px;
            font-weight: 700;
            color: #1a1a1a;
            letter-spacing: 1px;
        }

        /* Hide loop arrow */
        .loop-arrow {
            display: none;
        }

        /* Story Modal */
        .story-modal {
            position: fixed;
            inset: 0;
            background: rgba(0, 0, 0, 0.85);
            backdrop-filter: blur(10px);
            z-index: 3000;
            display: none;
            align-items: center;
            justify-content: center;
            padding: 40px;
            opacity: 0;
            transition: opacity 0.4s ease;
        }

        .story-modal.active {
            display: flex;
            opacity: 1;
        }

        .story-content {
            background: white;
            max-width: 900px;
            width: 100%;
            max-height: 90vh;
            overflow-y: auto;
            border-radius: 12px;
            box-shadow: 0 20px 60px rgba(0, 100, 0, 0.4);
            transform: scale(0.9) translateY(40px);
            transition: transform 0.5s cubic-bezier(0.4, 0, 0.2, 1);
        }

        .story-modal.active .story-content {
            transform: scale(1) translateY(0);
        }

        .story-content::-webkit-scrollbar {
            width: 6px;
        }

        .story-content::-webkit-scrollbar-track {
            background: #f0f0f0;
        }

        .story-content::-webkit-scrollbar-thumb {
            background: rgba(81, 81, 81, 0.2);
            border-radius: 4px;
        }

        .story-hero {
            width: 100%;
            height: 400px;
            background: #f0f0f0;
            display: flex;
            align-items: center;
            justify-content: center;
            color: #ccc;
            font-size: 14px;
            border-radius: 12px 12px 0 0;
        }

        .story-body {
            padding: 50px 60px;
        }

        .story-year {
            font-size: 13px;
            letter-spacing: 3px;
            color: #999;
            margin-bottom: 15px;
            text-transform: uppercase;
        }

        .story-title {
            font-family: 'Playfair Display', 'Georgia', serif;
            font-size: 42px;
            font-weight: 700;
            line-height: 1.2;
            color: #1a1a1a;
            margin-bottom: 30px;
        }

        .story-narrative {
            font-size: 18px;
            line-height: 1.8;
            color: #2a2a2a;
            margin-bottom: 40px;
        }

        .story-narrative p {
            margin-bottom: 20px;
        }

        .story-section {
            margin-bottom: 40px;
        }

        .story-section-title {
            font-size: 14px;
            letter-spacing: 2px;
            color: #DC143C;
            margin-bottom: 20px;
            text-transform: uppercase;
            border-bottom: 2px solid #006400;
            padding-bottom: 10px;
        }

        .story-gallery {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(200px, 1fr));
            gap: 15px;
        }

        .gallery-item {
            height: 200px;
            background: #f0f0f0;
            border-radius: 8px;
            display: flex;
            align-items: center;
            justify-content: center;
            color: #ccc;
            font-size: 11px;
        }

        .story-downloads {
            display: flex;
            flex-direction: column;
            gap: 15px;
        }

        .download-item {
            background: #fafafa;
            padding: 20px;
            border-radius: 8px;
            border-left: 4px solid #DC143C;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .download-btn {
            background: #006400;
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 4px;
            cursor: pointer;
            font-size: 12px;
            text-transform: uppercase;
            letter-spacing: 1px;
            transition: background 0.3s ease;
        }

        .download-btn:hover {
            background: #004d00;
        }

        .story-video {
            width: 100%;
            height: 400px;
            background: #000;
            border-radius: 8px;
            display: flex;
            align-items: center;
            justify-content: center;
            color: #666;
            font-size: 14px;
        }

        .close-modal {
            position: absolute;
            top: 20px;
            right: 20px;
            width: 40px;
            height: 40px;
            background: rgba(255, 255, 255, 0.9);
            border: none;
            border-radius: 50%;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 24px;
            color: #1a1a1a;
            transition: all 0.3s ease;
        }

        .close-modal:hover {
            background: white;
            transform: rotate(90deg);
        }

        .timeline-image img,
        .poster-image img,
        .gallery-item img,
        .story-hero img {
            width: 100%;
            height: 100%;
            object-fit: cover;
            display: block;
        }

        /* Responsive - Mobile: Vertical Stack */
        @media (max-width: 768px) {
            /* Switch to vertical scrolling on mobile */
            body {
                overflow-y: auto;
                overflow-x: hidden;
                height: auto;
            }

            .timeline-wrapper {
                height: auto;
                min-height: 100vh;
                flex-direction: column;
                padding: 80px 5vw 100px;
                overflow: visible;
            }

            .timeline-line {
                /* Vertical timeline line on mobile */
                top: 0;
                bottom: 0;
                left: 50%;
                right: auto;
                width: 2px;
                height: auto;
                transform: translateX(-50%);
            }

            .timeline-line::after {
                /* Vertical pulse animation */
                width: 2px;
                height: 100px;
                animation: timelinePulseMobile 3s ease-in-out infinite;
            }

            @keyframes timelinePulseMobile {
                0%, 100% { 
                    top: -100px;
                    opacity: 0;
                }
                50% { 
                    opacity: 1;
                }
            }

            .timeline-track {
                flex-direction: column;
                gap: 60px;
                width: 100%;
            }

            /* Hide cloned track on mobile */
            .timeline-track:nth-child(3) {
                display: none;
            }

            /* Decade markers - horizontal on mobile */
            .decade-marker {
                width: 100% !important;
                flex-direction: row;
                justify-content: center;
            }

            .decade-line {
                width: 80px;
                height: 1px;
            }

            .decade-label {
                position: static;
                transform: none;
            }

            /* Timeline moments - stack vertically */
            .timeline-moment {
                width: 100% !important;
                position: relative;
                min-height: auto;
            }

            /* Beads - centered on vertical line */
            .bead-container {
                left: 50%;
                top: 0;
                transform: translateX(-50%);
            }

            .connector-line.top {
                display: none;
            }

            .connector-line.bottom {
                height: 40px;
            }

            /* Cards and images - reset positioning */
            .timeline-card,
            .timeline-image {
                position: static !important;
                width: 100%;
                max-width: 500px;
                margin: 40px auto 0;
            }

            .timeline-moment.top .timeline-card,
            .timeline-moment.bottom .timeline-card {
                bottom: auto;
                top: auto;
            }

            .timeline-moment.top .timeline-image,
            .timeline-moment.bottom .timeline-image {
                top: auto;
                bottom: auto;
                margin-top: 20px;
            }

            /* Intermission section */
            .intermission-section {
                width: 100% !important;
                padding: 40px 20px;
            }

            .intermission-title {
                font-size: 28px;
            }

            .poster-gallery {
                flex-direction: column;
                gap: 20px;
            }

            .story-body {
                padding: 40px 30px;
            }

            .story-title {
                font-size: 32px;
            }

            .join-movement {
                top: 20px;
                right: 20px;
                padding: 10px 20px;
                font-size: 11px;
            }
        }

        /* Footer */
       /* Low-profile fixed footer */
       .site-footer {
           position: fixed;
           left: 0;
           right: 0;
           bottom: 0;
           height: 72px;
           padding: 10px 5vw;
           background: rgba(0,100,0,0.92);
           color: #fff;
           font-family: 'Georgia', serif;
           z-index: 2500;
          display: flex;
           align-items: center;
           box-shadow: 0 -6px 20px rgba(0,0,0,0.06);
       }
       .site-footer .container {
           display: flex;
           gap: 20px;
           width: 100%;
           align-items: center;
           justify-content: space-between;
            max-width: 1200px;
           margin: 0 auto;
       }
       .site-footer h4 { font-size: 14px; margin-bottom: 12px; font-weight:600; color: #fff; }
       .site-footer p, .site-footer a { color: rgba(255,255,255,0.95); text-decoration:none; font-size:12px; line-height:1.6; }
       .site-footer p, .site-footer a { color: rgba(255,255,255,0.9); text-decoration:none; font-size:12px; line-height:1.4; margin:0; }
       .site-footer .quick-links { display:flex; gap:12px; align-items:center; }
       .site-footer .quick-links a { font-weight:400; opacity:0.95; }
       .site-footer .social-icons { display:flex; gap:8px; align-items:center; margin:0; }
       .site-footer .social-icons a { width:32px; height:32px; display:inline-flex; align-items:center; justify-content:center; background: rgba(255,255,255,0.05); border-radius:4px; color:#fff; transition: transform 160ms ease, background 160ms ease; }
       .site-footer .social-icons a:hover { background: rgba(255,255,255,0.12); transform: translateY(-3px); }
       .site-footer .donate-cta { margin-top:12px; display:inline-block; background:#DC143C; color:#fff; padding:8px 14px; border-radius:8px; font-weight:700; text-decoration:none; }

       @media (max-width: 720px) {
           .site-footer .container { grid-template-columns: 1fr; text-align:left; }
           .site-footer { height: auto; padding: 12px 4vw; }
           .site-footer .container { flex-direction: column; align-items: flex-start; gap:8px; }
       }
    </style>
</head>
<body>
    <!-- Join the Movement Button -->
    <a id="joinMovementLink" class="join-movement" href="https://www.davidmaraga.com/volunteer" target="_blank" rel="noopener noreferrer">Join the Movement</a>


    <!-- NAV: floating logo that expands -->
    <div class="nav-toggle-container" id="navToggleContainer" aria-expanded="false">
        <button class="nav-toggle" id="navToggleBtn" aria-label="Open navigation" title="Menu">
            <img src="images/logo.png" alt="Maraga" onerror="this.style.display='none'; this.closest('.nav-toggle').textContent='M'">
        </button>

        <nav class="nav-bar" id="navBar" aria-hidden="true" role="navigation">
            <ul class="nav-links" role="menu" aria-label="Primary">
                <li role="none"><a role="menuitem" href="#">Home</a></li>
                <li role="none"><a role="menuitem" href="#">About</a></li>
                <li role="none"><a role="menuitem" href="#">Events</a></li>
           </ul>

            <div class="nav-actions" role="group" aria-label="Actions">
                <div class="social" aria-hidden="false">
                  <!-- Facebook -->
                    <a href="#" aria-label="Facebook" title="Facebook">
                        <svg viewBox="0 0 24 24" fill="currentColor" width="18" height="18"><path d="M22 12a10 10 0 1 0-11.5 9.9v-7h-2.2v-2.9H10.5V9.1c0-2.2 1.3-3.4 3.2-3.4.9 0 1.8.1 1.8.1v2h-1c-1 0-1.3.6-1.3 1.3v1.6h2.3l-.4 2.9h-1.9v7A10 10 0 0 0 22 12z"/></svg>
                    </a>
                    <!-- Instagram -->
                    <a href="https://www.instagram.com/dkmaraga__/" aria-label="Instagram" title="Instagram">
                        <svg viewBox="0 0 24 24" fill="currentColor" width="18" height="18"><path d="M7 2h10a5 5 0 0 1 5 5v10a5 5 0 0 1-5 5H7a5 5 0 0 1-5-5V7a5 5 0 0 1 5-5zm5 6.2A4.8 4.8 0 1 0 16.8 13 4.8 4.8 0 0 0 12 8.2zM18.4 6.3a1.1 1.1 0 1 0 1.1 1.1 1.1 1.1 0 0 0-1.1-1.1z"/></svg>
                    </a>
                    <!-- X / Twitter -->
                    <a href="https://x.com/dkmaraga" aria-label="X" title="X">
                       <svg viewBox="0 0 24 24" fill="currentColor" width="18" height="18"><path d="M22 5.9c-.6.3-1.2.5-1.9.6.7-.4 1.2-1 1.4-1.7-.6.4-1.3.7-2.1.9C18.9 4.6 18 4 17 4c-1.6 0-2.9 1.3-2.9 2.9 0 .2 0 .4.1.6C11.2 7.4 8.2 6 6 4.1c-.3.5-.5 1.2-.5 1.8 0 1.3.7 2.4 1.8 3-.5 0-1-.1-1.4-.4v.1c0 1.6 1.1 2.9 2.6 3.2-.3.1-.6.1-.9.1-.2 0-.4 0-.6-.1.4 1.3 1.6 2.2 3.1 2.2C8 18 6 18.6 4 18.3c1.8 1.1 3.9 1.7 6.1 1.7 7.4 0 11.5-6.1 11.5-11.5v-.5c.8-.6 1.4-1.3 1.9-2.1-.7.3-1.5.5-2.3.6z"/></svg>
                    </a>
                   <!-- YouTube -->
                    <a href="https://www.youtube.com/@dkmaraga" aria-label="YouTube" title="YouTube">
                        <svg viewBox="0 0 24 24" fill="currentColor" width="18" height="18"><path d="M23 7s-.2-1.5-.8-2.2c-.8-1-1.7-1-2.1-1.1C16.8 3.5 12 3.5 12 3.5h0s-4.8 0-8.1.2c-.4 0-1.3.1-2.1 1.1C1.2 5.5 1 7 1 7S1 8.7 1 10.5v3C1 17.3 1.2 19 1.2 19s.2 1.5.8 2.2c.8 1 1.8 1 2.3 1.1 1.7.1 7.4.2 7.4.2s4.8 0 8.1-.2c.4 0 1.3-.1 2.1-1.1.6-.7.8-2.2.8-2.2S23 14 23 12.5v-3C23 8.7 23 7 23 7zM9.8 15.5V9.5l5.6 3z"/></svg>
                    </a>
               </div>

                <a class="donate" href="https://donations.davidmaraga.com/" role="button">Donate</a>
            </div>
        </nav>
    </div>

    <div class="timeline-wrapper" id="timelineWrapper">
        <div class="timeline-line"></div>
        
        <div class="timeline-track">
            
            <!-- Decade Marker: 1950s -->
            <div class="decade-marker" style="width: 150px;">
                <div class="decade-line"><div class="decade-label">1950s</div></div>
            </div>

            <!-- 1. Coming of Age -->
            <div class="timeline-moment top" style="width: 400px;" data-moment="coming-of-age">
                <div class="bead-container">
                    <div class="connector-line top"></div>
                    <div class="bead"></div>
                    <div class="connector-line bottom"></div>
                </div>
                <div class="timeline-card">
                    <div class="card-year">1950s-1970s</div>
                    <h2 class="card-title">Coming of Age</h2>
                    <p class="card-description">
                        Childhood, education, and formative years shaped by faith, integrity, and determination.
                    </p>
                    <div class="explore-hint">explore...</div>
                </div>
                <div class="timeline-image" data-moment="coming-of-age">
                    <img src="images/coming-of-age-hero.jpg" alt="David Maraga - Coming of Age">
                </div>
            </div>

            <!-- Decade Marker: 1980s -->
            <div class="decade-marker" style="width: 150px;">
                <div class="decade-line"><div class="decade-label">1980s</div></div>
            </div>

            <!-- 2. Early Career as Advocate -->
            <div class="timeline-moment bottom" style="width: 400px;" data-moment="early-career">
                <div class="bead-container">
                    <div class="connector-line top"></div>
                    <div class="bead"></div>
                    <div class="connector-line bottom"></div>
                </div>
                <div class="timeline-image" data-moment="early-career">
                    <img src="images/early-career-hero.jpg" alt="David Maraga - Early Career">
                </div>
                <div class="timeline-card">
                    <div class="card-year">1980s</div>
                    <h2 class="card-title">Early Career as Advocate</h2>
                    <p class="card-description">
                        Beginning a legal career built on principles and dedication to justice.
                    </p>
                    <div class="explore-hint">explore...</div>
                </div>
            </div>

            <!-- Decade Marker: 1990s -->
            <div class="decade-marker" style="width: 150px;">
                <div class="decade-line"><div class="decade-label">1990s</div></div>
            </div>

            <!-- 3. Appointment as Judge -->
            <div class="timeline-moment top" style="width: 400px;" data-moment="appointment">
                <div class="bead-container">
                    <div class="connector-line top"></div>
                    <div class="bead"></div>
                    <div class="connector-line bottom"></div>
                </div>
                <div class="timeline-card">
                    <div class="card-year">1990s</div>
                    <h2 class="card-title">Maraga the Advocate</h2>
                    <p class="card-description">
                        Ascending to the bench, beginning a distinguished judicial career.
                    </p>
                    <div class="explore-hint">explore...</div>
                </div>
                <div class="timeline-image" data-moment="appointment">
                    <img src="images/maraga-advocate-hero.jpg" alt="David Maraga - The Advocate">
                </div>
            </div>

            <!-- Decade Marker: 2000s -->
            <div class="decade-marker" style="width: 150px;">
                <div class="decade-line"><div class="decade-label">2000s</div></div>
            </div>

            <!-- 4. Moving Up Judicial Ranks -->
            <div class="timeline-moment bottom" style="width: 400px;" data-moment="judicial-ranks">
                <div class="bead-container">
                    <div class="connector-line top"></div>
                    <div class="bead"></div>
                    <div class="connector-line bottom"></div>
                </div>
                <div class="timeline-image" data-moment="judicial-ranks">
                    <img src="images/maraga-judge-hero.jpg" alt="David Maraga - The Judge">
                </div>
                <div class="timeline-card">
                    <div class="card-year">2000s-2010s</div>
                    <h2 class="card-title">Moving Up Judicial Ranks</h2>
                    <p class="card-description">
                        Rising through the judiciary with distinction, building toward the highest office.
                    </p>
                    <div class="explore-hint">explore...</div>
                </div>
            </div>

            <!-- Decade Marker: 2010s -->
            <div class="decade-marker" style="width: 150px;">
                <div class="decade-line"><div class="decade-label">2010s</div></div>
            </div>

            <!-- 5. President of Supreme Court -->
            <div class="timeline-moment top" style="width: 400px;" data-moment="president-scok">
                <div class="bead-container">
                    <div class="connector-line top"></div>
                    <div class="bead"></div>
                    <div class="connector-line bottom"></div>
                </div>
                <div class="timeline-card">
                    <div class="card-year">2016</div>
                    <h2 class="card-title">President of Supreme Court</h2>
                    <p class="card-description">
                        Appointed Chief Justice. His vision for the judiciary: independence, integrity, and service.
                    </p>
                    <div class="explore-hint">explore...</div>
                </div>
                <div class="timeline-image" data-moment="president-scok">
                    <img src="images/president-scok-hero.jpg" alt="David Maraga - President of the Supreme Court of Kenya">
                </div>
            </div>

            <!-- 6. THE ANNULMENT -->
            <div class="timeline-moment bottom annulment-moment" style="width: 400px;" data-moment="annulment">
                <div class="bead-container">
                    <div class="connector-line top"></div>
                    <div class="bead"></div>
                    <div class="connector-line bottom"></div>
                </div>
                <div class="timeline-image" data-moment="annulment">
                    <img src="images/null-and-void-hero.jpg" alt="David Maraga - Annulment of 2017 Election">
                </div>
                <div class="timeline-card annulment-card">
                    <div class="card-year">September 1, 2017</div>
                    <h2 class="card-title">The Annulment</h2>
                    <p class="card-description">
                        The greatness of any nation lies in its fidelity to the constitution, adherance to the rule of law and above all respect to God.
                    </p>
                    <div class="explore-hint">explore...</div>
                </div>
            </div>

            <!-- Decade Marker: 2018 -->
            <div class="decade-marker" style="width: 150px;">
                <div class="decade-line"><div class="decade-label">2018</div></div>
            </div>

            <!-- 7. We Shall Revisit -->
            <div class="timeline-moment top" style="width: 400px;" data-moment="revisit">
                <div class="bead-container">
                    <div class="connector-line top"></div>
                    <div class="bead"></div>
                    <div class="connector-line bottom"></div>
                </div>
                <div class="timeline-card">
                    <div class="card-year">2018-2020</div>
                    <h2 class="card-title">"We Shall Revisit..."</h2>
                    <p class="card-description">
                        Judiciary persecuted. Maraga standing firm, defending judicial independence against power.
                    </p>
                    <div class="explore-hint">explore...</div>
                </div>
                <div class="timeline-image" data-moment="revisit">
                    <img src="images/we-shall-revisit-hero.jpg" alt="David Maraga - Under Persecution">
                </div>
            </div>

            <!-- Decade Marker: 2021 -->
            <div class="decade-marker" style="width: 150px;">
                <div class="decade-line"><div class="decade-label">2021</div></div>
            </div>

            <!-- 8. Judicial Legacy -->
            <div class="timeline-moment bottom" style="width: 400px;" data-moment="legacy">
                <div class="bead-container">
                    <div class="connector-line top"></div>
                    <div class="bead"></div>
                    <div class="connector-line bottom"></div>
                </div>
                <div class="timeline-image" data-moment="legacy">
                    <img src="images/judicial-legacy.jpg" alt="David Maraga - Judicial Legacy">
                </div>
                <div class="timeline-card">
                    <div class="card-year">2021</div>
                    <h2 class="card-title">Judicial Legacy</h2>
                    <p class="card-description">
                        Did he achieve his vision? What judges, lawyers, and Kenyans say about his impact.
                    </p>
                    <div class="explore-hint">explore...</div>
                </div>
            </div>

            <!-- Decade Marker: 2024 -->
            <div class="decade-marker" style="width: 150px;">
                <div class="decade-line"><div class="decade-label">2024</div></div>
            </div>

            <!-- 9. Presidential Ambitions -->
            <div class="timeline-moment top" style="width: 400px;" data-moment="presidential">
                <div class="bead-container">
                    <div class="connector-line top"></div>
                    <div class="bead"></div>
                    <div class="connector-line bottom"></div>
                </div>
                <div class="timeline-card">
                    <div class="card-year">2025-2027</div>
                    <h2 class="card-title">Maraga the 6th</h2>
                    <p class="card-description">
                        Maraga the man for the job. From guardian of law to candidate for the presidency.
                    </p>
                    <div class="explore-hint">explore...</div>
                </div>
                <div class="timeline-image" data-moment="presidential">
                    <img src="images/maraga-the-sixth-hero.jpg" alt="David Maraga - the 6th President of Kenya">
                </div>
            </div>

            <!-- 10. Rebuilding Kenya -->
            <div class="timeline-moment bottom" style="width: 400px;" data-moment="rebuilding">
                <div class="bead-container">
                    <div class="connector-line top"></div>
                    <div class="bead"></div>
                    <div class="connector-line bottom"></div>
                </div>
                <div class="timeline-image" data-moment="rebuilding">
                    <img src="images/rebuilding-kenya-hero.jpg" alt="David Maraga - Rebuilding Kenya">
                </div>
                <div class="timeline-card">
                    <div class="card-year">2027 - Maraga the 6th</div>
                    <h2 class="card-title">Let's Reset,Restore & Rebuild Kenya, kwa umoja</h2>
                    <p class="card-description">
                        His manifesto, key pillars, campaign calendar. Where the campaign trail leads—toward hope.
                    </p>
                    <div class="explore-hint">explore...</div>
                </div>
            </div>

            <!-- Decade Marker: 2027 -->
            <div class="decade-marker" style="width: 150px;">
                <div class="decade-line"><div class="decade-label">2027</div></div>
            </div>

            <!-- INTERMISSION / POSTER GALLERY - Playful Break Before Loop -->
            <div class="intermission-section" style="width: 600px;">
                <div class="intermission-title">On the campaign trail...</div>
                <div class="poster-gallery">
                    <div class="poster-card">
                        <div class="poster-image">
                            <img src="images/poster-reset.jpg" alt="Reset campaign poster">
                        </div>
                        <div class="poster-caption">Reset</div>
                    </div>
                    <div class="poster-card">
                        <div class="poster-image">
                            <img src="images/poster-restore.jpg" alt="Restore campaign poster">
                        </div>
                        <div class="poster-caption">Restore</div>
                    </div>
                    <div class="poster-card">
                        <div class="poster-image">
                            <img src="images/poster-rebuild.jpg" alt="Rebuild campaign poster">
                        </div>
                        <div class="poster-caption">Rebuild</div>
                    </div>
                </div>
            </div>

            <!-- Loop back marker - Hidden but keeps spacing -->
            <div class="decade-marker loop-back-marker" style="width: 100px;">
                <div class="decade-line"><div class="decade-label">→</div></div>
            </div>

        </div>
    </div>

    <!-- Duplicate timeline track for seamless infinite loop (hidden, will be cloned by JS) -->
    <template id="timeline-clone-template">
        <!-- Content will be cloned here by JavaScript -->
    </template>

    <!-- Story Modal -->
    <div class="story-modal" id="storyModal">
        <button class="close-modal" onclick="closeModal()">×</button>
        <div class="story-content">
            <div class="story-hero" id="storyHero">[Hero Image]</div>
            <div class="story-body" id="storyBody"></div>
        </div>
    </div>

    <!-- Site Footer -->
    <footer class="site-footer" role="contentinfo">
        <div class="container">
            <div class="footer-col">
                <h4>Campaign Headquarters</h4>
                <p>82 Westlands Rd, Nairobi, Kenya</p>
                <p>+254 746 900 027</p>
            </div>

            <div class="footer-col quick-links">
                <a href="https://www.davidmaraga.com/pillars">Pillars</a>
                <a href="https://www.davidmaraga.com/about">About Us</a>
                <a href="https://donations.davidmaraga.com/">Donate</a>
                <a href="https://www.davidmaraga.com/volunteer">Join the Movement</a>
            </div>

            <div class="footer-col">
                <div class="social-icons" aria-label="Social links">
                    <a href="#" aria-label="Facebook" title="Facebook" target="_blank" rel="noopener noreferrer">
                        <svg viewBox="0 0 24 24" width="18" height="18" fill="currentColor"><path d="M22 12a10 10 0 1 0-11.5 9.9v-7h-2.2v-2.9H10.5V9.1c0-2.2 1.3-3.4 3.2-3.4.9 0 1.8.1 1.8.1v2h-1c-1 0-1.3.6-1.3 1.3v1.6h2.3l-.4 2.9h-1.9v7A10 10 0 0 0 22 12z"/></svg>
                    </a>
                    <a href="https://www.instagram.com/dkmaraga__/" aria-label="Instagram" title="Instagram" target="_blank" rel="noopener noreferrer">
                        <svg viewBox="0 0 24 24" width="18" height="18" fill="currentColor"><path d="M7 2h10a5 5 0 0 1 5 5v10a5 5 0 0 1-5 5H7a5 5 0 0 1-5-5V7a5 5 0 0 1 5-5zm5 6.2A4.8 4.8 0 1 0 16.8 13 4.8 4.8 0 0 0 12 8.2zM18.4 6.3a1.1 1.1 0 1 0 1.1 1.1 1.1 1.1 0 0 0-1.1-1.1z"/></svg>
                    </a>
                    <a href="https://x.com/dkmaraga" aria-label="X" title="X" target="_blank" rel="noopener noreferrer">
                        <svg viewBox="0 0 24 24" width="18" height="18" fill="currentColor"><path d="M22 5.9c-.6.3-1.2.5-1.9.6.7-.4 1.2-1 1.4-1.7-.6.4-1.3.7-2.1.9C18.9 4.6 18 4 17 4c-1.6 0-2.9 1.3-2.9 2.9 0 .2 0 .4.1.6C11.2 7.4 8.2 6 6 4.1c-.3.5-.5 1.2-.5 1.8 0 1.3.7 2.4 1.8 3-.5 0-1-.1-1.4-.4v.1c0 1.6 1.1 2.9 2.6 3.2-.3.1-.6.1-.9.1-.2 0-.4 0-.6-.1.4 1.3 1.6 2.2 3.1 2.2C8 18 6 18.6 4 18.3c1.8 1.1 3.9 1.7 6.1 1.7 7.4 0 11.5-6.1 11.5-11.5v-.5c.8-.6 1.4-1.3 1.9-2.1-.7.3-1.5.5-2.3.6z"/></svg>
                    </a>
                    <a href="https://www.youtube.com/@dkmaraga" aria-label="YouTube" title="YouTube" target="_blank" rel="noopener noreferrer">
                        <svg viewBox="0 0 24 24" width="18" height="18" fill="currentColor"><path d="M23 7s-.2-1.5-.8-2.2c-.8-1-1.7-1-2.1-1.1C16.8 3.5 12 3.5 12 3.5h0s-4.8 0-8.1.2c-.4 0-1.3.1-2.1 1.1C1.2 5.5 1 7 1 7S1 8.7 1 10.5v3C1 17.3 1.2 19 1.2 19s.2 1.5.8 2.2c.8 1 1.8 1 2.3 1.1 1.7.1 7.4.2 7.4.2s4.8 0 8.1-.2c.4 0 1.3-.1 2.1-1.1.6-.7.8-2.2.8-2.2S23 14 23 12.5v-3C23 8.7 23 7 23 7zM9.8 15.5V9.5l5.6 3z"/></svg>
                    </a>
                </div>
           </div>
        </div>
    </footer>

    <script>
        const wrapper = document.getElementById('timelineWrapper');
        const track = document.querySelector('.timeline-track');
        const cards = document.querySelectorAll('.timeline-card');
        const images = document.querySelectorAll('.timeline-image');
        const modal = document.getElementById('storyModal');
        const storyBody = document.getElementById('storyBody');

        // Clone the timeline content to create seamless infinite loop
        const trackClone = track.cloneNode(true);
        track.parentElement.appendChild(trackClone);

        // Get all cards and images after cloning
        const allCards = document.querySelectorAll('.timeline-card');
        const allImages = document.querySelectorAll('.timeline-image');

        // Intersection Observer for visibility
        const observer = new IntersectionObserver((entries) => {
            entries.forEach(entry => {
                if (entry.isIntersecting) {
                    entry.target.classList.add('visible');
                }
            });
        }, { threshold: 0.3 });

        allCards.forEach(card => observer.observe(card));
        allImages.forEach(image => observer.observe(image));

        // Vertical to Horizontal Scroll with Elastic Bounce
        let targetScrollLeft = 0;
        let springOffset = 0; // Visual spring effect for cards
        
         window.addEventListener('wheel', (e) => {
            const storyContentEl = document.querySelector('.story-content');
            const timelineWrapper = document.getElementById('timelineWrapper');

            // 1) If modal is open and pointer is inside modal -> allow native scrolling
            if (modal.classList.contains('active') && storyContentEl && storyContentEl.contains(e.target)) {
                return; // let browser handle it
            }

            // 2) If we're in mobile/vertical mode, let native vertical scrolling happen.
            //    Adjust the matchMedia breakpoint to match your vertical-mode breakpoint if different.
            const isVerticalMode = window.matchMedia('(max-width: 768px)').matches || document.body.classList.contains('vertical-scroll');
            if (isVerticalMode) return;

            // 3) If the pointer is over the timeline area -> capture and do horizontal scroll.
            if (timelineWrapper && timelineWrapper.contains(e.target)) {
                e.preventDefault(); // needed to stop vertical page move
                const delta = e.deltaY || e.deltaX;
                targetScrollLeft += delta * 1.5;
            }
            // else: allow native behavior (scroll page) — do nothing
        }, { passive: false });

        // Seamless infinite loop with elastic bounce at start
        const originalTrackWidth = track.scrollWidth;
        
        function checkInfiniteLoop() {
            let scrollLeft = window.scrollX;
            
            // Forward infinite loop
            if (targetScrollLeft >= originalTrackWidth) {
                const offset = targetScrollLeft - originalTrackWidth;
                targetScrollLeft = offset;
                window.scrollTo({ left: offset, behavior: 'auto' });
            }
            
            // Elastic bounce at start (0 position)
            if (targetScrollLeft < 0) {
                // Spring force pulls back to 0
                const springForce = -targetScrollLeft * 0.15;
                targetScrollLeft += springForce;
                
                // Visual spring offset for cards
                springOffset = targetScrollLeft * 0.5; // Half the negative value for visual effect
                
                // Apply spring effect to all cards
                allCards.forEach(card => {
                    card.style.transform = `translateY(0) translateX(${springOffset}px)`;
                });
                allImages.forEach(img => {
                    img.style.transform = `translateY(0) translateX(${springOffset}px)`;
                });
                
                // If very close to 0, snap to 0
                if (Math.abs(targetScrollLeft) < 0.5) {
                    targetScrollLeft = 0;
                    springOffset = 0;
                    // Reset card transforms
                    allCards.forEach(card => {
                        card.style.transform = '';
                    });
                    allImages.forEach(img => {
                        img.style.transform = '';
                    });
                }
            } else {
                // No spring effect when not at boundary
                springOffset = 0;
            }
            
            // Apply the scroll position
            window.scrollTo({ left: targetScrollLeft, behavior: 'auto' });
            
            requestAnimationFrame(checkInfiniteLoop);
        }
        
        checkInfiniteLoop();

        // Click handlers for cards and images
        let lastSourceEl = null;

        allCards.forEach(card => {
            card.addEventListener('click', (ev) => {
                const moment = card.closest('[data-moment]')?.dataset.moment;
                if (moment) {
                    lastSourceEl = ev.currentTarget.closest('[data-moment]') || ev.currentTarget;
                    openStory(moment, lastSourceEl);
                }
            });
        });

        allImages.forEach(image => {
            image.addEventListener('click', (ev) => {
                const moment = image.dataset.moment;
                if (moment) {
                    lastSourceEl = ev.currentTarget;
                    openStory(moment, lastSourceEl);
                }
            });
        });

        // Story data for each moment
        const storyData = {
            'coming-of-age': {
                year: '1950s-1970s',
                title: 'Coming of Age',
                narrative: `
                    <p>David Kenani Maraga was born on January 12, 1951, in Bonyamatuta, South Nyanza District, Nyanza Province, Kenya.  
                    <p>Early Eduction : Sironga DEB Primary School, Maranda High School and Kisii High School.   
                    <p>Higher Education :  Bachelor of Laws (LLB) and a Master of Laws (LLM) from the University of Nairobi.   
                    <p>He also holds a post-graduate diploma from the Kenya School of Law.   
                    <p>He was admitted to the Kenyan bar in October 1978. </p>
                `,
                hero: 'images/coming-of-age-hero.jpg',
                images: [
                    'images/gallery/coming-1.jpg',
                    'images/gallery/coming-2.jpg',
                    'images/gallery/coming-3.jpg'
                ],
                gallery: true,
                downloads: [],
                video: false
            },
            'early-career': {
                year: '1980s',
                title: 'Early Career as Advocate',
                narrative: `
                    <p>Before joining the Judiciary, Justice Maraga was a legal practitioner for 25 years in conveyancing, civil and criminal litigation. </p>
                    <p>He also served as the Chairman of the Rift Valley Law Society and as a member of the Constitutional Review Task Force of the Seventh-day Adventist Church, East African Union.</p>
                `,
                hero: 'images/coming-of-age-hero.jpg',
                images: [
                    'images/gallery/coming-1.jpg',
                    'images/gallery/coming-2.jpg',
                    'images/gallery/coming-3.jpg'
                ],
                gallery: true,
                downloads: [],
                video: false
            },
            'appointment': {
                year: '1990s',
                title: 'Maraga the Advocate',
                narrative: `
                    <p>Maraga's appointment to the bench marked the beginning of a distinguished judicial career characterized by fairness, integrity, and dedication to the law.</p>
                `,
                hero: 'images/early-career-hero.jpg',
                images: [
                    'images/gallery/early-1.jpg',
                    'images/gallery/early-2.jpg',
                    'images/gallery/early-3.jpg'
                ],
                gallery: true,
                downloads: [],
                video: false
            },
            'judicial-ranks': {
                year: '2000s-2010s',
                title: 'Maraga the Judge',
                narrative: `
                    <p>Maraga was tapped by the Law Society of Kenya in 2003 for a High Court judgeship, then appointed without interview, under Kenya's old constitution.</p>
                    <p>He served in Mombasa, Nakuru and Nairobi before rising to the Court of Appeal in 2012</p>
                `,
                hero: 'images/maraga-the-judge-hero.jpg',
                images: [
                    'images/gallery/judge-1.jpg',
                    'images/gallery/judge-2.jpg',
                    'images/gallery/judge-3.jpg'
                ],
                gallery: true,
                downloads: [],
                video: false
            },
            'president-scok': {
                year: '2016',
                title: 'President of Supreme Court',
                narrative: `
                    <p>Appointed Chief Justice in 2016, Maraga brought a vision of judicial independence, integrity, and service to the people of Kenya.</p>
                `,
                hero: 'images/president-scok-hero.jpg',
                images: [
                    'images/gallery/cjmaraga-1.jpg',
                    'images/gallery/cjmaraga-2.jpg',
                    'images/gallery/cjmaraga-3.jpg'
                ],
                gallery: true,
                downloads: [],
                video: true
            },
            'annulment': {
                year: 'September 1, 2017',
                title: 'The Annullment',
                narrative: `
                    <p>When the Supreme Court annulled the 2017 presidential election, it was a historic first for Africa, and only the fourth such decision globally.</p>
                    <p>“To me, it was a case like any other,” he says. “But this was a presidential election; it was more sensitive.”
                    <p>The decision required relentless work. “We had 14 days. Lawyers used about five. That left us very little time. I was sleeping two hours a night,” he recalls.</p>
                    <p>This was the day where decades happened. The Maraga Judgment became a defining moment in Kenya's democratic journey.</p>
                `,
                hero: 'images/null-and-void-hero.jpg',
                images: [
                    'images/gallery/annuled-1.jpg',
                    'images/gallery/annuled-2.jpg',
                    'images/gallery/annuled-3.jpg',
                    'images/gallery/annuled-4.jpg',
                    'images/gallery/annuled-5.jpg',
                    'images/gallery/annuled-6.jpg'
                ],
                gallery: true,
                downloads: [
                    { name: 'Supreme Court Ruling - Full Judgment', file: 'ruling.pdf' },
                    { name: 'Press Statement - September 2017', file: 'statement.pdf' }
                ],
                video: true,
                videoUrl: 'https://www.youtube.com/watch?v=GGCweC43WlI',
            },
            'revisit': {
                year: '2018-2020',
                title: '"We Shall Revisit..."',
                narrative: `
                    <p>Following the 2017 annulment, the judiciary faced persecution and pressure. Maraga stood firm, defending judicial independence against political interference.</p>
                    <p>His famous words "We shall revisit this matter" became a rallying cry for the rule of law.</p>
                `,
                hero: 'images/we-shall-revisit-hero.jpg',
                images: [
                    'images/gallery/revisit-1.jpg',
                    'images/gallery/revisit-2.jpg',
                    'images/gallery/revisit-3.jpg'
                ],
                gallery: true,
                downloads: [],
                video: true
            },
            'legacy': {
                year: '2021',
                title: 'Judicial Legacy',
                narrative: `
                    <p>Upon retirement, Maraga left behind a powerful legacy. Judges, lawyers, and citizens reflect on his impact on Kenya's judiciary and democracy.</p>
                    <p>Did he achieve his vision? The answer lies in the strengthened institutions and renewed faith in the rule of law.</p>
                `,
                hero: 'images/judicial-legacy.jpg',
                images: [
                    'images/gallery/legacy-1.jpg',
                    'images/gallery/legacy-2.jpg',
                    'images/gallery/legacy-3.jpg'
                ],
                gallery: true,
                downloads: [],
                video: false
            },
            'presidential': {
                year: '2025-2027',
                title: 'Presidential Ambitions',
                narrative: `
                    <p>From guardian of the law to candidate for the highest office in the land. David Maraga steps forward with a vision for Kenya built on integrity, justice, and hope.</p>
                    <p>The man who stood up to power now seeks to lead the nation toward a better future.</p>
                `,
                hero: 'images/maraga-the-sixth-hero.jpg',
                images: [
                    'images/gallery/the-sixth-1.jpg',
                    'images/gallery/the-sixth-2.jpg',
                    'images/gallery/the-sixth-3.jpg',
                    'images/gallery/the-sixth-4.jpg'
                ],
                gallery: true,
                downloads: [],
                video: true
            },
            'rebuilding': {
                year: '2027',
                title: 'Let`s Reset, Restore and Rebuild Kenya, kwa umoja',
                narrative: `
                    <p>Maraga's manifesto focuses on key pillars: strengthening institutions, fighting corruption, economic transformation, and restoring hope.</p>
                    <p>The campaign trail leads across Kenya, meeting citizens and sharing a vision of a country that works for everyone.</p>
                `,
                hero: 'images/rebuilding-kenya-hero.jpg',
                images: [
                    'images/gallery/rebuild-1.jpg',
                    'images/gallery/rebuild-2.jpg',
                    'images/gallery/rebuild-3.jpg'
                ],
                gallery: true,
                downloads: [
                    { name: 'Campaign Pillars', url: 'https://www.davidmaraga.com/pillars' },
                    { name: 'Policy Positions', url: 'https://www.davidmaraga.com/press' }
                ],
                video: true
            }
        };

        // NAV toggle behaviour (floating logo -> expanded menu)
        (function () {
            const container = document.getElementById('navToggleContainer');
            if (!container) return;
            const btn = document.getElementById('navToggleBtn');
            const bar = document.getElementById('navBar');

            const openNav = () => {
                container.classList.add('open');
                container.setAttribute('aria-expanded', 'true');
                btn.setAttribute('aria-expanded', 'true');
                bar.setAttribute('aria-hidden', 'false');
                // click outside to close
                setTimeout(() => document.addEventListener('click', outsideHandler));
            };

            const closeNav = () => {
                container.classList.remove('open');
                container.setAttribute('aria-expanded', 'false');
                btn.setAttribute('aria-expanded', 'false');
                bar.setAttribute('aria-hidden', 'true');
                document.removeEventListener('click', outsideHandler);
            };

            const outsideHandler = (ev) => {
                if (!container.contains(ev.target)) closeNav();
            };

            btn.addEventListener('click', (ev) => {
               ev.stopPropagation();
                if (container.classList.contains('open')) closeNav();
                else openNav();
            });

            // auto-close the nav on user scroll / wheel / touchmove to reduce clutter
            const autoCloseOnInteraction = () => {
                if (container.classList.contains('open')) closeNav();
            };
            window.addEventListener('scroll', autoCloseOnInteraction, { passive: true });
            window.addEventListener('wheel', autoCloseOnInteraction, { passive: true });
            window.addEventListener('touchmove', autoCloseOnInteraction, { passive: true });

            // keyboard support
            document.addEventListener('keydown', (ev) => {
                if (ev.key === 'Escape') closeNav();
            });
        })();
        // helper: convert many YouTube URL forms to an /embed/ URL
        function getYouTubeEmbed(url) {
            if (!url) return null;
            const m = url.match(/(?:v=|\/videos\/|embed\/|youtu\.be\/|\/v\/)([A-Za-z0-9_-]{6,11})/);
            const id = m ? m[1] : null;
            return id ? `https://www.youtube.com/embed/${id}?rel=0&modestbranding=1` : url;
        }

        // Open story modal with morph animation from sourceEl (card or image)
        function openStory(moment, sourceEl) {
            const data = storyData[moment] || storyData['annulment'];

            // render hero & content first
            const storyHero = document.getElementById('storyHero');
            if (data.hero) storyHero.innerHTML = `<img src="${data.hero}" alt="${data.title}">`;
            else storyHero.innerHTML = '[Hero Image]';

            let content = `
                <div class="story-year">${data.year}</div>
                <h1 class="story-title">${data.title}</h1>
                <div class="story-narrative">${data.narrative}</div>
            `;
            // gallery, downloads, video as before
            if (data.gallery) {
                content += `<div class="story-section">
                                <div class="story-section-title">Gallery</div>
                                <div class="story-gallery">`;
                if (Array.isArray(data.images) && data.images.length) {
                    data.images.forEach(src => {
                        content += `<div class="gallery-item"><img src="${src}" alt=""></div>`;
                    });
                } else {
                    content += `<div class="gallery-item">[Image]</div>`;
                }
                content += `   </div></div>`;
            }
            if (data.downloads && data.downloads.length) {
                content += `<div class="story-section"><div class="story-section-title">Documents</div><div class="story-downloads">`;
                 data.downloads.forEach(doc => {
                    const href = doc.url || '#';
                    content += `<div class="download-item">
                                    <span>${doc.name}</span>
                                    <a class="download-btn" href="${href}" target="_blank" rel="noopener noreferrer">Open</a>
                                </div>`;
                });
                content += `</div></div>`;
            }
            if (data.video) {
                const embed = getYouTubeEmbed(data.videoUrl);
                if (embed) {
                    content += `<div class="story-section">
                                    <div class="story-section-title">Video</div>
                                    <div class="story-video">
                                        <iframe src="${embed}" frameborder="0"
                                            allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture"
                                            allowfullscreen style="width:100%;height:100%;min-height:320px;border-radius:8px;"></iframe>
                                    </div>
                                </div>`;
                } else {
                    content += `<div class="story-section"><div class="story-section-title">Video</div><div class="story-video">Video not available</div></div>`;
                }
            }
            content += `<div class="story-section" style="text-align:center;padding:40px 0;"><button class="join-movement" style="position:static;" onclick="alert('Join the Movement!')">Join the Movement</button></div>`;

            storyBody.innerHTML = content;

            // Morph animation:
            const storyContent = document.querySelector('.story-content');

            // make modal visible but disable transition to measure final rect
            modal.classList.add('active');
            storyContent.style.transition = 'none';
            storyContent.style.transformOrigin = 'center center';

            // force layout so final rect can be measured
            const finalRect = storyContent.getBoundingClientRect();
            const sourceRect = (sourceEl && sourceEl.getBoundingClientRect()) || finalRect;

            // compute transform that maps final -> source (start state)
            const scaleX = sourceRect.width / finalRect.width;
            const scaleY = sourceRect.height / finalRect.height;
            const translateX = (sourceRect.left + sourceRect.width / 2) - (finalRect.left + finalRect.width / 2);
            const translateY = (sourceRect.top + sourceRect.height / 2) - (finalRect.top + finalRect.height / 2);

            // apply start transform (so content appears over the source)
            storyContent.style.transform = `translate(${translateX}px, ${translateY}px) scale(${scaleX}, ${scaleY})`;
            storyContent.style.borderRadius = window.getComputedStyle(sourceEl)?.borderRadius || '12px';

            // force repaint then animate to final (identity) state
            requestAnimationFrame(() => {
                storyContent.style.transition = 'transform 520ms cubic-bezier(0.22, 0.9, 0.3, 1), border-radius 320ms ease';
                storyContent.style.transform = 'translate(0px, 0px) scale(1, 1)';
                storyContent.style.borderRadius = '12px';
            });

            document.body.style.overflow = 'hidden';
        }

        // Close story modal and stop any playing media (iframes/videos)
        function closeModal() {
            const storyContent = document.querySelector('.story-content');

            // Immediately stop embedded iframes (YouTube) by clearing src
            if (storyContent) {
                const iframes = storyContent.querySelectorAll('iframe');
                iframes.forEach(iframe => {
                    // optional: store src if you want to reuse later (not required here)
                    iframe.dataset.origSrc = iframe.src || '';
                    iframe.src = '';
                });

                // Pause any <video> elements and reset time
                const videos = storyContent.querySelectorAll('video');
                videos.forEach(v => {
                    try { v.pause(); v.currentTime = 0; } catch (e) {}
                });
            }

            // Soft fade + slight scale down for modal content
            storyContent.style.transition = 'transform 220ms cubic-bezier(0.2,0,0.2,1), opacity 260ms ease';
            storyContent.style.transform = 'scale(0.96) translateY(12px)';
            storyContent.style.opacity = '0';

            // fade overlay
            modal.style.transition = 'opacity 260ms ease';
            modal.style.opacity = '0';

            const cleanup = () => {
                modal.classList.remove('active');
                // reset inline styles added for the animation
               modal.style.transition = '';
                modal.style.opacity = '';
                if (storyContent) {
                    storyContent.style.transition = '';
                    storyContent.style.transform = '';
                    storyContent.style.opacity = '';
                }
                document.body.style.overflow = 'auto';
                modal.removeEventListener('transitionend', onEnd);
            };

            const onEnd = (ev) => {
                // wait for overlay transition to finish
                if (ev.target === modal) cleanup();
            };

            modal.addEventListener('transitionend', onEnd);
            // safety fallback
            setTimeout(cleanup, 450);
        }

        // Close modal on background click
        modal.addEventListener('click', (e) => {
            if (e.target === modal) closeModal();
        });

        // Keyboard navigation
        document.addEventListener('keydown', (e) => {
            if (e.key === 'Escape') closeModal();
            if (e.key === 'ArrowLeft') {
                window.scrollBy({ left: -window.innerWidth * 0.5, behavior: 'smooth' });
            } else if (e.key === 'ArrowRight') {
                window.scrollBy({ left: window.innerWidth * 0.5, behavior: 'smooth' });
            }
        });
    </script>
</body>
</html>